\subsection{Модуль обеспечения совместной работы пользователей} \label{research_competition}

При совместной конкурентной работе пользователей в системе электронного документооборота существует проблема синхронизации вносимых изменений. Так, два редактора, работая над одним документом (но каждый со своим набором задач), во время внесения изменений блокируют работу друг друга, так как документ в рассматрвиаемом контексте -- ограниченный ресурс. Схема такой модели в среде AnyLogic представлена на рис. \ref{img:competition_old_scheme}.

\begin{figure}[h]
  \centering
  \includegraphics[width=1\textwidth]{competition_old_scheme}
  \caption{Схема конкурентной обработки документа с блокировкой}
  \label{img:competition_old_scheme}
\end{figure}

Здесь объекты $source$ моделируют источники заявок (по одной заявке в полчаса), $queue$ -- персональные очереди заявок на обработку, $hold$ -- элемент, блокирующий работу редактора (когда работает первый редактор, второй блокируется, и наоборот), $delay$ -- редакторы (время обработки заявки распределяется по нормальному закону со средним значением 25 минут, $\sigma=5$), $sink$ -- целевое хранилище, собирающее обработанные заявки.

\vspace{\baselineskip}
Альтернативой является такая схема организации обработки документов, при которой разрешено одновременное внесение изменений в документ, что справедливо для разрабатываемой системы. Это становится возможным благодаря регистрации не состояний документа, а вносимых в него изменений в виде разницы текущего и предыдущего состояний. Такая разностная запись называется <<патч>>. Пример патча см. на рис. \ref{img:git_patch}.

\begin{figure}[h]
  \centering
  \includegraphics[width=1\textwidth]{git_patch}
  \caption{Пример записи состояния документа в виде патча}
  \label{img:git_patch}
\end{figure}

Данная реализация позволяет не только сократить объём хранимых данных, но и реализовать вышеописанную схему, ведь при таком подходе одновременное внесение изменений несколькими редакторами рассматривается не как изменение одного документа, а как создание набора новых записей. Результирующий документ получается путём последовательного применения таких патчей к исходному документу.

\vspace{\baselineskip}
Схема этой модели в среде AnyLogic представлена на рис. \ref{img:competition_new_scheme}.

\begin{figure}[h]
  \centering
  \includegraphics[width=1\textwidth]{competition_new_scheme}
  \caption{Схема конкурентной обработки документа без блокировки}
  \label{img:competition_new_scheme}
\end{figure}

\vspace{\baselineskip}
Элементы на этой схеме совпадают с элементами схемы рис. \ref{img:competition_old_scheme}, однако здесь отсутствуют блоки $hold$, а время обработки заявки распределяется по нормальному закону со средним значением 30 минут, $\sigma=6$ (из расчёта временного запаса на устранение ошибок слияния при одновременном переходе обработанных заявок в блок $sink$).

\vspace{\baselineskip}
В процессе эксперимента был промоделирован один рабочий день (с 9:00 до 18:00), в течение которого каждому из редакторов на обработку поступило 19 заявок. Число обработанных заявок в схеме с блокировкой показано на рис. \ref{img:competition_old_done}, в схеме без блокировок -- на рис. \ref{img:competition_new_done}.

\begin{figure}[h]
  \centering
  \includegraphics[width=1\textwidth]{competition_old_done}
  \caption{Число обработанных заявок в схеме с блокировкой}
  \label{img:competition_old_done}
\end{figure}

\begin{figure}[h]
  \centering
  \includegraphics[width=1\textwidth]{competition_new_done}
  \caption{Число обработанных заявок в схеме без блокировки}
  \label{img:competition_new_done}
\end{figure}

\vspace{\baselineskip}
Как видно из представленных результатов, несмотря на б\textit{о}льшее среднее время обработки одной заявки, число успешно обработанных заявок в схеме без блокировки за один рабочий день в $~1.5$ раза больше, чем число успешно обработанных заявок в схеме с блокировкой за тот же период. Также по этим рисункам видно, что за счёт блокировок заявки редакторами в первой схеме обрабатывались неравномерно, в отличие от второй схемы. Дополнительным подтверждением этому служат временные диаграммы загруженности редакторов в течение рабочего дня, представленные на рис. \ref{img:competition_old_gantt} и \ref{img:competition_new_gantt}.

\begin{figure}[h]
  \centering
  \includegraphics[width=1\textwidth]{competition_old_gantt}
  \caption{Временная диаграмма загруженности редакторов в течение рабочего дня в схеме с блокировкой}
  \label{img:competition_old_gantt}
\end{figure}

\begin{figure}[h]
  \centering
  \includegraphics[width=1\textwidth]{competition_new_gantt}
  \caption{Временная диаграмма загруженности редакторов в течение рабочего дня в схеме без блокировки}
  \label{img:competition_new_gantt}
\end{figure}

\vspace{\baselineskip}
Эти рисунки наглядно показывают время бездействия редакторов в схеме с блокировкой (два редактора работают с загрузкой, равной 100\% загрузке одного редактора). Такого продолжительного простоя можно избежать только обрабатывая параллельно несколько документов так, чтобы время блокировок сводилось к минимуму. Таким образом, появляется дополнительная задача временн\textit{о}го планирования. При этом схема без блокировок помогает эффективно использовать рабочее время без дополнительного планирования.

\vspace{\baselineskip}
Ещё один немаловажный показатель -- загруженность очереди на обработку. Соответствующие графики приведены на рис. \ref{img:competition_old_queue} и \ref{img:competition_new_queue}.

\begin{figure}[h]
  \centering
  \includegraphics[width=1\textwidth]{competition_old_queue}
  \caption{Загруженность очереди на обработку в схеме с блокировкой}
  \label{img:competition_old_queue}
\end{figure}

\begin{figure}[h]
  \centering
  \includegraphics[width=1\textwidth]{competition_new_queue}
  \caption{Загруженность очереди на обработку в схеме без блокировки}
  \label{img:competition_new_queue}
\end{figure}

\vspace{\baselineskip}
Как видно, при использовании схемы с блокировкой заполняемость очереди имеет тенденцию к росту, что в конечном итоге приведёт к ситуации, в которой заявки одного конкретного редактора будут полностью удовлетворены только по завершении работ остальными редакторами. В то же время, очереди в схеме без блокировок не имеют подобной тенденции, и заявки, находящиеся в них, своевременно удовлетворяются.

\vspace{\baselineskip}
Таким образом, при совместной работе пользователей над одним документом в системе электронного документооборота целесообразно использовать предложенную схему организации процесса без блокировок.